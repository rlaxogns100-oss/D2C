# 1. 메인 랜딩 페이지 (maejang.com)
maejang.com {
    root * /home/ubuntu/D2C/01_Homepage
    file_server
    log {
        output file /var/log/caddy/maejang.access.log
    }
}

# 2. 고객용 페이지 (pizzaschool.maejang.com)
pizzaschool.maejang.com {
    
    # [우선순위 1] 백엔드 API
    # /api/로 시작하는 요청은 무조건 백엔드로 보낸다.
    handle /api/* {
        reverse_proxy localhost:8080
    }

    # [우선순위 2] 관리자 페이지
    handle_path /admin/* {
        root * /home/ubuntu/D2C/02_Owner
        file_server
        try_files {path} {path}/ /01_Loading.html
    }

    # [우선순위 3] 나머지 모든 요청 (고객용 정적 파일)
    # 위에서 처리되지 않은 요청만 여기로 온다.
    handle {
        root * /home/ubuntu/D2C/03_Customer
        file_server
        try_files {path} {path}/ /01_Loading.html
    }

    log {
        output file /var/log/caddy/pizzaschool.access.log
    }
}
